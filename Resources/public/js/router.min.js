!function(e,t){var n=t();"function"==typeof define&&define.amd?define([],n.Routing):"object"==typeof module&&module.exports?module.exports=n.Routing:(e.Routing=n.Routing,e.fos={Router:n.Router})}(this,function(){function e(){return e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},e.apply(this,arguments)}function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var i={};Object.defineProperty(i,"__esModule",{value:!0}),i.Routing=i.Router=void 0;var u=function(){function o(e,t){n(this,o),this.context_=e||{base_url:"",prefix:"",host:"",port:"",scheme:"",locale:""},this.setRoutes(t||{})}return r(o,[{key:"setRoutingData",value:function(e){this.setBaseUrl(e.base_url),this.setRoutes(e.routes),"prefix"in e&&this.setPrefix(e.prefix),"port"in e&&this.setPort(e.port),"locale"in e&&this.setLocale(e.locale),this.setHost(e.host),this.setScheme(e.scheme)}},{key:"setRoutes",value:function(e){this.routes_=Object.freeze(e)}},{key:"getRoutes",value:function(){return this.routes_}},{key:"setBaseUrl",value:function(e){this.context_.base_url=e}},{key:"getBaseUrl",value:function(){return this.context_.base_url}},{key:"setPrefix",value:function(e){this.context_.prefix=e}},{key:"setScheme",value:function(e){this.context_.scheme=e}},{key:"getScheme",value:function(){return this.context_.scheme}},{key:"setHost",value:function(e){this.context_.host=e}},{key:"getHost",value:function(){return this.context_.host}},{key:"setPort",value:function(e){this.context_.port=e}},{key:"getPort",value:function(){return this.context_.port}},{key:"setLocale",value:function(e){this.context_.locale=e}},{key:"getLocale",value:function(){return this.context_.locale}},{key:"buildQueryParams",value:function(e,n,o){var r,i=this,u=new RegExp(/\[\]$/);if(n instanceof Array)n.forEach(function(n,r){u.test(e)?o(e,n):i.buildQueryParams(e+"["+("object"===t(n)?r:"")+"]",n,o)});else if("object"===t(n))for(r in n)this.buildQueryParams(e+"["+r+"]",n[r],o);else o(e,n)}},{key:"getRoute",value:function(e){var t=this.context_.prefix+e,n=e+"."+this.context_.locale,o=this.context_.prefix+e+"."+this.context_.locale,r=[t,n,o,e];for(var i in r)if(r[i]in this.routes_)return this.routes_[r[i]];throw new Error('The route "'+e+'" does not exist.')}},{key:"generate",value:function(t,n,r){var i=this.getRoute(t),u=n||{},s=e({},u),c="",a=!0,l="",f="undefined"==typeof this.getPort()||null===this.getPort()?"":this.getPort();if(i.tokens.forEach(function(e){if("text"===e[0])return c=o.encodePathComponent(e[1])+c,void(a=!1);{if("variable"!==e[0])throw new Error('The token type "'+e[0]+'" is not supported.');var n=i.defaults&&e[3]in i.defaults;if(!1===a||!n||e[3]in u&&u[e[3]]!=i.defaults[e[3]]){var r;if(e[3]in u)r=u[e[3]],delete s[e[3]];else{if(!n){if(a)return;throw new Error('The route "'+t+'" requires the parameter "'+e[3]+'".')}r=i.defaults[e[3]]}var l=!0===r||!1===r||""===r;if(!l||!a){var f=o.encodePathComponent(r);"null"===f&&null===r&&(f=""),c=e[1]+f+c}a=!1}else n&&e[3]in s&&delete s[e[3]]}}),""===c&&(c="/"),i.hosttokens.forEach(function(e){var t;return"text"===e[0]?void(l=e[1]+l):void("variable"===e[0]&&(e[3]in u?(t=u[e[3]],delete s[e[3]]):i.defaults&&e[3]in i.defaults&&(t=i.defaults[e[3]]),l=e[1]+t+l))}),c=this.context_.base_url+c,i.requirements&&"_scheme"in i.requirements&&this.getScheme()!=i.requirements._scheme){var h=l||this.getHost();c=i.requirements._scheme+"://"+h+(h.indexOf(":"+f)>-1||""===f?"":":"+f)+c}else if("undefined"!=typeof i.schemes&&"undefined"!=typeof i.schemes[0]&&this.getScheme()!==i.schemes[0]){var p=l||this.getHost();c=i.schemes[0]+"://"+p+(p.indexOf(":"+f)>-1||""===f?"":":"+f)+c}else l&&this.getHost()!==l+(l.indexOf(":"+f)>-1||""===f?"":":"+f)?c=this.getScheme()+"://"+l+(l.indexOf(":"+f)>-1||""===f?"":":"+f)+c:r===!0&&(c=this.getScheme()+"://"+this.getHost()+(this.getHost().indexOf(":"+f)>-1||""===f?"":":"+f)+c);if(Object.keys(s).length>0){var y,g=[],m=function(e,t){t="function"==typeof t?t():t,t=null===t?"":t,g.push(o.encodeQueryComponent(e)+"="+o.encodeQueryComponent(t))};for(y in s)this.buildQueryParams(y,s[y],m);c=c+"?"+g.join("&")}return c}}],[{key:"getInstance",value:function(){return s}},{key:"setData",value:function(e){var t=o.getInstance();t.setRoutingData(e)}},{key:"customEncodeURIComponent",value:function(e){return encodeURIComponent(e).replace(/%2F/g,"/").replace(/%40/g,"@").replace(/%3A/g,":").replace(/%21/g,"!").replace(/%3B/g,";").replace(/%2C/g,",").replace(/%2A/g,"*").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/'/g,"%27")}},{key:"encodePathComponent",value:function(e){return o.customEncodeURIComponent(e).replace(/%3D/g,"=").replace(/%2B/g,"+").replace(/%21/g,"!").replace(/%7C/g,"|")}},{key:"encodeQueryComponent",value:function(e){return o.customEncodeURIComponent(e).replace(/%3F/g,"?")}}]),o}();i.Router=u;var s=new u;return i.Routing=s,{Router:u,Routing:s}});